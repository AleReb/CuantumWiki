<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="CuantumWiki ‚Äî App de tokenizaci√≥n y detecci√≥n de tono. Env√≠a texto a nodos ESP32 via Web Serial API.">
    <title>CuantumWiki ‚Äî Tokenizer + Detecci√≥n de Tono</title>
    <link rel="stylesheet" href="app.css">
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>‚öõ</text></svg>">
</head>

<body>

    <!-- ‚ïê‚ïê‚ïê HEADER ‚ïê‚ïê‚ïê -->
    <header class="header">
        <a href="#" class="header-logo">
            <div class="logo-icon">‚öõ</div>
            <h1>CuantumWiki</h1>
        </a>
        <div class="header-center">
            <a href="index.html" class="btn btn-sm btn-secondary">üìñ Wiki</a>
        </div>
        <div class="header-right">
            <span id="serial-status" class="serial-status disconnected">
                <span class="dot"></span> Desconectado
            </span>
            <button id="btn-connect" class="btn btn-sm btn-primary">üîå Conectar Serial</button>
            <button id="btn-disconnect" class="btn btn-sm btn-danger" style="display:none;">‚èè Desconectar</button>
        </div>
    </header>

    <!-- ‚ïê‚ïê‚ïê APP ‚ïê‚ïê‚ïê -->
    <div class="app">
        <div class="grid-main">

            <!-- ‚îÄ‚îÄ Left Column: Input + Results ‚îÄ‚îÄ -->
            <div>
                <!-- Input Panel -->
                <div class="panel">
                    <div class="panel-header">
                        <div class="panel-icon purple">‚úçÔ∏è</div>
                        <div>
                            <div class="panel-title">Entrada de Texto</div>
                            <div class="panel-subtitle">Escribe el mensaje para analizar su tono</div>
                        </div>
                    </div>
                    <div class="panel-body">
                        <textarea id="text-input" class="text-input-area"
                            placeholder="Escribe un mensaje aqu√≠ para analizar su tono...&#10;&#10;Ejemplo: &quot;Necesito esto urgente por favor&quot;&#10;Ctrl+Enter para enviar"
                            spellcheck="false"></textarea>
                        <div class="input-footer">
                            <span id="char-count" class="char-count">0 chars</span>
                            <div class="send-row">
                                <button id="btn-send" class="btn btn-primary">
                                    ‚ö° Analizar Tono
                                </button>
                            </div>
                        </div>

                        <!-- Token Preview -->
                        <div class="token-preview">
                            <div class="token-preview-label">Tokens <span id="token-count">0 / 64</span></div>
                            <div id="token-chips" class="tokens-container">
                                <span style="color: var(--text-muted); font-size: 0.8rem;">Escribe algo para ver los
                                    tokens...</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Results Panel -->
                <div class="panel section-gap">
                    <div class="panel-header">
                        <div class="panel-icon green">üìä</div>
                        <div>
                            <div class="panel-title">Resultados</div>
                            <div class="panel-subtitle">Clasificaci√≥n de tono / intenci√≥n</div>
                        </div>
                        <div class="panel-actions">
                            <button id="btn-clear" class="btn btn-sm btn-secondary">üóëÔ∏è Limpiar</button>
                        </div>
                    </div>
                    <div class="panel-body">
                        <div id="results-container">
                            <div id="results-empty" class="empty-state">
                                <div class="empty-icon">üí¨</div>
                                <h3>Sin resultados a√∫n</h3>
                                <p>Escribe un texto y presiona "Analizar" para detectar el tono.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ‚îÄ‚îÄ Right Column: Nodes + Config + Log ‚îÄ‚îÄ -->
            <div class="sidebar-right">

                <!-- Nodes Panel -->
                <div class="panel">
                    <div class="panel-header">
                        <div class="panel-icon cyan">üî∂</div>
                        <div>
                            <div class="panel-title">Nodos ESP32-C3</div>
                            <div class="panel-subtitle">Estado de workers</div>
                        </div>
                    </div>
                    <div class="panel-body">
                        <div class="nodes-grid">

                            <div class="node-card">
                                <div class="node-card-header">
                                    <span class="node-name">c3-0</span>
                                    <span id="node-0-status" class="node-status unknown"></span>
                                </div>
                                <div class="node-detail"><span>Addr</span><span class="val">0x10</span></div>
                                <div class="node-detail"><span>Infers</span><span class="val"
                                        id="node-0-infers">0</span></div>
                                <div class="node-detail"><span>Latencia</span><span class="val"
                                        id="node-0-latency">--</span></div>
                                <div class="node-detail"><span>√öltimo</span><span class="val" id="node-0-last">--</span>
                                </div>
                            </div>

                            <div class="node-card">
                                <div class="node-card-header">
                                    <span class="node-name">c3-1</span>
                                    <span id="node-1-status" class="node-status unknown"></span>
                                </div>
                                <div class="node-detail"><span>Addr</span><span class="val">0x11</span></div>
                                <div class="node-detail"><span>Infers</span><span class="val"
                                        id="node-1-infers">0</span></div>
                                <div class="node-detail"><span>Latencia</span><span class="val"
                                        id="node-1-latency">--</span></div>
                                <div class="node-detail"><span>√öltimo</span><span class="val" id="node-1-last">--</span>
                                </div>
                            </div>

                            <div class="node-card">
                                <div class="node-card-header">
                                    <span class="node-name">c3-2</span>
                                    <span id="node-2-status" class="node-status unknown"></span>
                                </div>
                                <div class="node-detail"><span>Addr</span><span class="val">0x12</span></div>
                                <div class="node-detail"><span>Infers</span><span class="val"
                                        id="node-2-infers">0</span></div>
                                <div class="node-detail"><span>Latencia</span><span class="val"
                                        id="node-2-latency">--</span></div>
                                <div class="node-detail"><span>√öltimo</span><span class="val" id="node-2-last">--</span>
                                </div>
                            </div>

                            <div class="node-card">
                                <div class="node-card-header">
                                    <span class="node-name">c3-3</span>
                                    <span id="node-3-status" class="node-status unknown"></span>
                                </div>
                                <div class="node-detail"><span>Addr</span><span class="val">0x13</span></div>
                                <div class="node-detail"><span>Infers</span><span class="val"
                                        id="node-3-infers">0</span></div>
                                <div class="node-detail"><span>Latencia</span><span class="val"
                                        id="node-3-latency">--</span></div>
                                <div class="node-detail"><span>√öltimo</span><span class="val" id="node-3-last">--</span>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>

                <!-- Config Panel -->
                <div class="panel">
                    <div class="panel-header">
                        <div class="panel-icon amber">‚öôÔ∏è</div>
                        <div>
                            <div class="panel-title">Configuraci√≥n</div>
                            <div class="panel-subtitle">Par√°metros de inferencia</div>
                        </div>
                    </div>
                    <div class="panel-body">
                        <div class="config-row">
                            <span class="config-label">Modelo</span>
                            <span class="config-value">tone-v1</span>
                        </div>
                        <div class="config-row">
                            <span class="config-label">Max tokens</span>
                            <input id="config-maxlen" type="number" class="config-input" value="64" min="16" max="128"
                                step="16">
                        </div>
                        <div class="config-row">
                            <span class="config-label">Routing</span>
                            <select id="config-route" class="config-input">
                                <option value="auto">auto (round-robin)</option>
                                <option value="c3-0">c3-0</option>
                                <option value="c3-1">c3-1</option>
                                <option value="c3-2">c3-2</option>
                                <option value="c3-3">c3-3</option>
                            </select>
                        </div>
                        <div class="config-row">
                            <span class="config-label">Clases</span>
                            <div style="display: flex; gap: 4px; flex-wrap: wrap;">
                                <span class="tag neutral">neutral</span>
                                <span class="tag positivo">positivo</span>
                                <span class="tag urgente">urgente</span>
                                <span class="tag molesto">molesto</span>
                                <span class="tag formal">formal</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Log Console -->
                <div class="panel">
                    <div class="panel-header">
                        <div class="panel-icon purple">üìù</div>
                        <div>
                            <div class="panel-title">Log Serial</div>
                            <div class="panel-subtitle">Comunicaci√≥n JSONL</div>
                        </div>
                    </div>
                    <div class="panel-body" style="padding: 12px;">
                        <div id="log-console" class="log-console"></div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>

</html>